# HFT Forecast – Model Training Repository

This repository contains the **model training code** for the HFT forecasting pipeline.

⚠️ **Large market data (SLIM Parquet / ZIP files) is NOT stored in GitHub.**  
All multi-GB data is stored in **Cloudflare R2 (S3-compatible object storage)** and downloaded locally using scripts in this repo.

---

# Design Principles

- GitHub → code, scripts, documentation
- GitHub → no large data, no trained models
- Cloudflare R2 → SLIM Parquet & ZIP data (2–3 GB per file)
- Deterministic local file structure for training
- Date-scoped model outputs for reproducibility

---

# Expected Local Directory Structure

The training code assumes the following structure exists locally:

```
~/HFT_forecast/
├── model_data/
│   └── <yyyy>/
│       └── daily/
│           ├── live_YYYYMMDD_ES*_SLIM.parquet
│           ├── live_YYYYMMDD_ZN*_SLIM.parquet
│           └── ...
│
├── fit_data/
│   └── roll30/
│       └── live/
│           └── <startdate>_<enddate>/
│               ├── model.pt
│               ├── model_config.json
│               └── metrics.json
│
├── logs_hft/
│   └── train/
│       ├── train_YYYYMMDD.log
│       └── ...
│
├── scripts/
│   └── r2_download.py
│
├── HFT_LSTM_train_POST30_ms_torch_multitask_b.py
└── README.md

```
# Input Data

## Required input path
~/HFT_forecast/model_data/<yyyy>/daily/*.SLIM.parquet

- One file per symbol per trading day
- Generated by the live SLIM / Databento pipeline
- Data must be downloaded from Cloudflare R2 before training

# Model Outputs

## Output model path

```
~/HFT_forecast/fit_data/roll30/live/<startdate>_<enddate>/
```
## Each training run writes:
- .pt : trained PyTorch model
-	.json : model configuration / metadata
-	Optional summary CSVs and metrics

## This structure allows multiple rolling windows to coexist cleanly.

# Training Logs

## Log path

```
~/HFT_forecast/logs_hft/train/*.log
```
- One or more logs per training run
- Includes data range, hyperparameters, and training diagnostics

# Training Script

## Primary training entry point

```
~/HFT_forecast/HFT_LSTM_train_POST30_ms_torch_multitask_b.py
```

## This script:
- Reads SLIM Parquet files from model_data/<yyyy>/daily/
- Trains POST30 multi-task LSTM models
- Writes outputs to fit_data/roll30/live/<startdate>_<enddate>/
- Emits logs to logs_hft/train/

# Cloudflare R2 (Large Data Storage)

# All large data files are stored in Cloudflare R2 (S3-compatible, no egress fees).

# Bucket
